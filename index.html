<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Combo Digital ‚Äî 300+ Libros (Bs 25)</title>
  <style>
    :root{
      --bg:#070a14; --card:#0f1630; --muted:#9aa6c7; --text:#eaf0ff;
      --accent:#7c5cff; --accent2:#31d0aa; --danger:#ff4d6d;
      --radius:18px; --shadow: 0 14px 34px rgba(0,0,0,.45);
      --line: 1px solid rgba(255,255,255,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(1100px 700px at 15% 0%, rgba(124,92,255,.25), transparent 60%),
        radial-gradient(900px 500px at 95% 15%, rgba(49,208,170,.18), transparent 55%),
        var(--bg);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:20px}
    header{
      position:sticky;top:0;z-index:30;
      backdrop-filter: blur(10px);
      background: rgba(7,10,20,.65);
      border-bottom: var(--line);
    }
    .topbar{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:12px 20px;max-width:1100px;margin:0 auto;
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{
      width:38px;height:38px;border-radius:12px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: var(--shadow);
    }
    .brand h1{font-size:15px;margin:0}
    .brand p{margin:0;color:var(--muted);font-size:12px}

    .btn{
      border:0;cursor:pointer;color:var(--text);
      padding:11px 14px;border-radius: 14px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      display:inline-flex;align-items:center;gap:10px;justify-content:center;
      user-select:none;
      font-weight:800;
    }
    .btn:hover{background: rgba(255,255,255,.12); border-color: rgba(255,255,255,.18)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,92,255,.95), rgba(49,208,170,.85));
      border:0;
      box-shadow: 0 12px 26px rgba(124,92,255,.18);
    }
    .btn.danger{
      background: rgba(255,77,109,.10);
      border-color: rgba(255,77,109,.35);
    }
    .btn.danger:hover{background: rgba(255,77,109,.16)}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      background: rgba(255,255,255,.07);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
      padding:18px 0 10px;
      align-items:stretch;
    }
    .card{
      background: rgba(15,22,48,.78);
      border: var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .heroLeft{padding:18px}
    .title{font-size:34px;line-height:1.08;margin:0 0 10px}
    .subtitle{margin:0;color:var(--muted);max-width:62ch}
    .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}

    .priceBox{
      margin-top:14px;
      display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end;
      padding:12px;border-radius:16px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
    }
    .price{font-size:30px;font-weight:900}
    .old{color:var(--muted);text-decoration:line-through;font-weight:700}
    .note{font-size:12px;color:var(--muted)}
    .ctaRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}

    .heroRight{display:flex;flex-direction:column}
    .slider{padding:14px;display:flex;flex-direction:column;gap:12px;}
    .coverWrap{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      min-height: 320px;
      display:flex;align-items:center;justify-content:center;
    }
    .coverWrap img{width:100%;height: 380px;object-fit: cover;display:block;}
    .sliderControls{display:flex;justify-content:space-between;gap:10px;align-items:center;}
    .mini{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
      width:100%;
    }
    .mini:hover{background: rgba(255,255,255,.10)}
    .dotRow{display:flex;gap:6px;justify-content:center}
    .dot{
      width:8px;height:8px;border-radius:99px;
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(255,255,255,.18);
      cursor:pointer;
    }
    .dot.active{background: rgba(49,208,170,.75)}

    .section{margin-top:14px}
    .sectionHeader{
      display:flex;justify-content:space-between;gap:10px;align-items:center;
      padding:14px 16px;border-bottom: var(--line);
    }
    .sectionHeader h2{margin:0;font-size:16px}
    .grid2{display:grid;grid-template-columns: 1fr 1fr;gap:12px;padding:14px;}
    .box{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      padding:12px;
    }
    .box h3{margin:0 0 6px;font-size:14px}
    .box p{margin:0;color:var(--muted);font-size:13px;line-height:1.35}

    .finalCta{
      padding:16px;
      display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;
    }
    .finalCta .left{max-width:70ch}
    .finalCta h3{margin:0 0 6px;font-size:16px}
    .finalCta p{margin:0;color:var(--muted);font-size:13px}

    .foot{padding: 18px 0 26px;text-align:center;color: var(--muted);font-size: 12px;}

    /* Modal cat√°logo */
    .modalBack{
      position:fixed; inset:0; display:none;
      background: rgba(0,0,0,.55);
      z-index: 60;
      padding: 16px;
    }
    .modal{
      max-width: 960px;
      margin: 0 auto;
      border-radius: 18px;
      background: rgba(15,22,48,.95);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      overflow:hidden;
      max-height: calc(100vh - 32px);
      display:flex;
      flex-direction:column;
    }
    .modalHeader{
      display:flex;gap:10px;align-items:center;justify-content:space-between;
      padding: 12px 14px;
      border-bottom: var(--line);
    }
    .modalHeader h3{margin:0;font-size:15px}
    .modalBody{padding:14px; overflow:auto}
    .searchRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .input{
      flex:1; min-width: 220px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:0;
    }
    .small{font-size:12px;color:var(--muted)}
    .list{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
    }
    .book{
      display:grid;
      grid-template-columns: 120px 1fr;
      gap:10px;
      padding:10px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      align-items:center;
    }
    .thumb{
  width:120px;
  height:180px;
  border-radius:14px;
  background: linear-gradient(135deg, rgba(124,92,255,.75), rgba(49,208,170,.55));
  border: 1px solid rgba(255,255,255,.10);
  overflow:hidden;
}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .book b{display:block;font-size:13px}
    .book span{display:block;color:var(--muted);font-size:12px;line-height:1.25}
    .pager{
      display:flex;justify-content:space-between;gap:10px;align-items:center;
      margin-top:12px;
      padding-top:12px;
      border-top: 1px dashed rgba(255,255,255,.18);
    }

    /* Admin import */
    details.admin{margin-top:14px}
    details.admin > summary{
      cursor:pointer; list-style:none; user-select:none;
      padding: 12px 14px;
      border-radius: 16px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      font-weight:900;
    }
    details.admin > summary::-webkit-details-marker{display:none}
    textarea{
      width:100%;
      min-height:160px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      margin-top:10px;
    }

    /* WhatsApp flotante */
    .waFloat{position:fixed; right:16px; bottom:16px; z-index:70;}

    @media (max-width: 980px){
      .hero{grid-template-columns:1fr}
      .grid2{grid-template-columns:1fr}
      .coverWrap img{height: 440px}
      .list{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Combo Digital ‚Ä¢ 300+ Libros</h1>
          <p>Antes Bs 45 ‚Ä¢ Solo por hoy Bs 25</p>
        </div>
      </div>
      <a class="btn primary" id="waTop" href="#" target="_blank" rel="noopener">üü¢ Comprar por WhatsApp</a>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="card">
        <div class="heroLeft">
          <div class="pill">‚è≥ SOLO POR HOY</div>
          <h2 class="title">Accede a <span style="color:#d9d2ff">300+ libros</span> por <span style="color:#bfffea">Bs 25</span>.</h2>
          <p class="subtitle">
            Pack digital: te lo env√≠o por WhatsApp/Drive (seg√∫n acuerdes). Ideal para quien quiere aprender,
            mejorar su criterio y tener material de lectura por meses.
          </p>

          <div class="badges">
            <span class="pill">‚úÖ 1 sola compra</span>
            <span class="pill">üì© Entrega digital</span>
            <span class="pill">‚ö° Compra en 1 minuto</span>
          </div>

          <div class="priceBox">
            <div>
              <div class="note">Precio de hoy</div>
              <div class="price" id="priceNow">Bs 25.00</div>
            </div>
            <div>
              <div class="note">Antes</div>
              <div class="old" id="priceOld">Bs 45.00</div>
            </div>
            <div style="margin-left:auto">
              <div class="note">Incluye</div>
              <div style="font-weight:900" id="count">300+ libros</div>
            </div>
          </div>

          <div class="ctaRow">
            <a class="btn primary" id="waHero" href="#" target="_blank" rel="noopener">üü¢ Quiero el pack</a>
            <button class="btn" id="openCatalog">üìö Ver cat√°logo</button>
          </div>

          <div class="note" style="margin-top:10px">
            ‚ÄúSi hoy te decides, te lo env√≠o apenas confirmemos el pago.‚Äù ‚úÖ
          </div>
        </div>
      </div>

      <div class="card heroRight">
        <div class="slider">
          <div class="coverWrap">
            <img id="coverImg" src="" alt="Portada" />
          </div>

          <div class="sliderControls">
            <button class="mini" id="prev">‚üµ Anterior</button>
            <button class="mini" id="next">Siguiente ‚ü∂</button>
          </div>

          <div class="dotRow" id="dots"></div>
          <div class="note" id="coverCaption"></div>
        </div>
      </div>
    </section>

    <section class="card section">
      <div class="sectionHeader">
      </div>
      <div class="grid2">
        <div class="box">
          <h3>üéØ ‚ÄúHoy cuesta menos que un caf√© y te queda para siempre‚Äù</h3>
          <p>Antes Bs 45, hoy Bs 25. Es el momento de aprovechar.</p>
        </div>
        <div class="box">
          <h3>‚ö° ‚ÄúCompra en 1 minuto por WhatsApp‚Äù</h3>
          <p>Te abre el chat con el mensaje listo. Solo confirmas y te lo env√≠o.</p>
        </div>
        <div class="box">
          <h3>üìö ‚Äú300+ libros, una sola compra‚Äù</h3>
          <p>Ideal si quieres variedad: aprendizaje, h√°bitos, mente, estrategia, etc.</p>
        </div>
        <div class="box">
          <h3>‚è≥ ‚ÄúSolo por hoy‚Äù</h3>
        </div>
      </div>
    </section>

    <section class="card section">
      <div class="finalCta">
        <div class="left">
          <h3>¬øListo para llevarte el pack digital?</h3>
          <p>Haz clic y te abre WhatsApp con el mensaje preparado. Precio de hoy: Bs 25.</p>
        </div>
        <a class="btn primary" id="waBottom" href="#" target="_blank" rel="noopener">üü¢ Comprar ahora</a>
      </div>
    </section>

    <details class="admin card" style="padding:14px">
      <summary>üõ†Ô∏è Cargar tus 300+ libros (copiar/pegar lista)</summary>
      <div class="small" style="margin-top:10px">
        Pega tu cat√°logo aqu√≠ en formato <b>una l√≠nea por libro</b>:<br/>
        <code>T√≠tulo | Autor | imagenURL(opcional)</code><br/>
        Ejemplo:<br/>
        <code>Psicolog√≠a Oscura | James Williams | https://miurl.com/psico.jpg</code>
      </div>

      <textarea id="importBox" placeholder="Pega aqu√≠ tu lista..."></textarea>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        <button class="btn primary" id="importBtn">‚úÖ Importar cat√°logo</button>
        <button class="btn" id="exportBtn">üì§ Exportar cat√°logo</button>
        <button class="btn danger" id="resetBtn">‚ôªÔ∏è Restaurar demo</button>
      </div>

      <div class="small" id="importStatus" style="margin-top:10px"></div>
    </details>

    <div class="foot">¬© <span id="year"></span> ‚Ä¢ Landing ‚ÄúPack digital‚Äù</div>
  </main>

  <div class="waFloat">
    <a class="btn primary" id="waFloat" href="#" target="_blank" rel="noopener">üü¢ WhatsApp</a>
  </div>

  <!-- Modal cat√°logo -->
  <div class="modalBack" id="modalBack" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Cat√°logo">
      <div class="modalHeader">
        <h3>üìö Cat√°logo (300+)</h3>
        <div style="display:flex;gap:10px;align-items:center">
          <span class="pill" id="catCount">0 libros</span>
          <button class="btn" id="closeCatalog">‚úñ Cerrar</button>
        </div>
      </div>
      <div class="modalBody">
        <div class="searchRow">
          <input class="input" id="search" placeholder="Buscar por t√≠tulo o autor..." />
          <select class="input" id="pageSize" style="flex:0;min-width:160px">
            <option value="12">12 por p√°gina</option>
            <option value="24" selected>24 por p√°gina</option>
            <option value="48">48 por p√°gina</option>
          </select>
        </div>
        <div class="small" style="margin-top:8px" id="resultInfo"></div>
        <div class="list" id="catalogList"></div>

        <div class="pager">
          <button class="btn" id="prevPage">‚üµ P√°gina</button>
          <div class="pill" id="pageInfo">P√°gina 1</div>
          <button class="btn" id="nextPage">P√°gina ‚ü∂</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========= 1) CAMBIA TU N√öMERO AQU√ç (sin + ni espacios) =========
    // Bolivia ejemplo: 5917XXXXXXX
    const WHATSAPP_NUMBER = "59177104485";

    // ========= 2) CONFIG DE TU OFERTA =========
    const OFFER = {
      name: "Pack Digital 300+ Libros",
      priceNow: 25.00,
      priceOld: 45.00,
      delivery: "Entrega digital",
      waMessage:
`Hola, quiero comprar el *Pack Digital (300+ libros)* üìö
‚úÖ Precio de hoy: Bs 25 (antes Bs 45)
¬øEst√° disponible? ¬øC√≥mo me lo env√≠as y c√≥mo realizo el pago?`
    };

    // ========= 3) CAT√ÅLOGO (se guarda en el tel√©fono) =========
    // Puedes importar tu lista en la secci√≥n "Cargar tus 300+ libros".
    const LS_KEY = "pack_catalog_v1";

const DEMO_CATALOG = [
  {
    title: "C√≥mo eliminar el miedo y obtener lo que deseas",
    author: "Alex Yanza",
    img: "imagenes/obtenerdesea.jpg"
  },
  {
    title: "Persuasi√≥n: T√©cnicas prohibidas de manipulaci√≥n mental",
    author: "Hayden J. Power",
    img: "imagenes/manipulacion.jpg"
  },
  {
    title: "El oscuro carisma de Hitler",
    author: "Laurence Rees",
    img: "imagenes/carisma.jpg"
  },
  {
    title: "Persuasi√≥n y Poder",
    author: "Fernando Miralles",
    img: "imagenes/persuacion.jpg"
  },
  {
    title: "H√°bitos at√≥micos",
    author: "James Clear",
    img: "imagenes/atomicos.jpg"
  },
  {
    title: "Diccionario de Psicoan√°lisis",
    author: "Laplanche & Pontalis",
    img: "imagenes/psicoanalisis.jpg"
  },
  {
    title: "Gu√≠a para detectar mentiras",
    author: "Steven Torrent",
    img: "imagenes/mentiras.jpg"
  },
  {
    title: "Manipulaci√≥n mental para principiantes",
    author: "Charlie Wood",
    img: "imagenes/principiantes.jpg"
  },
  {
    title: "Psicolog√≠a oscura e inteligencia emocional",
    author: "Jos√© Villa",
    img: "imagenes/inteligenciaemocional.jpg"
  },
  {
    title: "Empat√≠a por el diablo",
    author: "Ignacio Mart√≠nez Mayoral",
    img: "imagenes/diablo.jpg"
  }
];

    function loadCatalog(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return [...DEMO_CATALOG];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) && parsed.length ? parsed : [...DEMO_CATALOG];
      }catch{
        return [...DEMO_CATALOG];
      }
    }
    function saveCatalog(){
      localStorage.setItem(LS_KEY, JSON.stringify(state.catalog));
      updateCounts();
      renderCatalog();
      renderSlider();
    }

    // ========= Helpers =========
    const $ = (id) => document.getElementById(id);
    function money(n){ return `Bs ${Number(n).toFixed(2)}`; }
    function esc(s){
      return String(s ?? "")
        .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;");
    }

    // ========= Estado =========
    const state = {
      catalog: loadCatalog(),
      sliderIndex: 0,
      search: "",
      page: 1,
      pageSize: 24
    };

    // ========= WhatsApp =========
    function setWhatsAppLinks(){
      const text = encodeURIComponent(OFFER.waMessage);
      const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${text}`;
      ["waTop","waHero","waBottom","waFloat"].forEach(id => $(id).href = url);
    }

    // ========= Slider (usa los primeros libros con imagen o, si no hay, placeholders) =========
    function sliderBooks(){
      // Preferir libros con img, si no, usa los primeros 6
      const withImg = state.catalog.filter(b => b.img && b.img.trim());
      const base = (withImg.length ? withImg : state.catalog).slice(0, 8);
      return base.length ? base : [...DEMO_CATALOG];
    }

    function renderSlider(){
      const arr = sliderBooks();
      if (!arr.length) return;
      if (state.sliderIndex >= arr.length) state.sliderIndex = 0;

      const b = arr[state.sliderIndex];
      const img = b.img && b.img.trim()
        ? b.img.trim()
        : `data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
          <svg xmlns='http://www.w3.org/2000/svg' width='800' height='1200'>
            <defs>
              <linearGradient id='g' x1='0' x2='1' y1='0' y2='1'>
                <stop offset='0' stop-color='#7c5cff' stop-opacity='0.9'/>
                <stop offset='1' stop-color='#31d0aa' stop-opacity='0.8'/>
              </linearGradient>
            </defs>
            <rect width='100%' height='100%' fill='url(#g)'/>
            <rect x='60' y='60' width='680' height='1080' rx='40' fill='rgba(0,0,0,0.20)'/>
            <text x='100' y='220' fill='white' font-size='64' font-family='Arial' font-weight='700'>${(b.title||"Libro").slice(0,22)}</text>
            <text x='100' y='310' fill='white' opacity='0.85' font-size='40' font-family='Arial'>${(b.author||"Autor").slice(0,26)}</text>
            <text x='100' y='1030' fill='white' opacity='0.9' font-size='36' font-family='Arial'>Pack Digital</text>
          </svg>
        `)}`;

      $("coverImg").src = img;
      $("coverImg").alt = `Portada: ${b.title}`;
      $("coverCaption").textContent = `${b.title} ‚Äî ${b.author || "Autor"}`;

      // dots
      $("dots").innerHTML = arr.map((_, i) =>
        `<span class="dot ${i===state.sliderIndex ? "active":""}" onclick="goToSlide(${i})"></span>`
      ).join("");
    }

    function nextSlide(){
      const arr = sliderBooks();
      state.sliderIndex = (state.sliderIndex + 1) % arr.length;
      renderSlider();
    }
    function prevSlide(){
      const arr = sliderBooks();
      state.sliderIndex = (state.sliderIndex - 1 + arr.length) % arr.length;
      renderSlider();
    }
    window.goToSlide = (i) => { state.sliderIndex = i; renderSlider(); };

    // ========= Modal cat√°logo =========
    function openModal(){
      $("modalBack").style.display = "block";
      $("modalBack").setAttribute("aria-hidden","false");
      renderCatalog(true);
      setTimeout(() => $("search").focus(), 50);
    }
    function closeModal(){
      $("modalBack").style.display = "none";
      $("modalBack").setAttribute("aria-hidden","true");
    }

    function filtered(){
      const q = state.search.trim().toLowerCase();
      if (!q) return state.catalog;
      return state.catalog.filter(b =>
        (b.title||"").toLowerCase().includes(q) ||
        (b.author||"").toLowerCase().includes(q)
      );
    }

    function renderCatalog(resetPage=false){
      if (resetPage) state.page = 1;

      const items = filtered();
      const total = items.length;
      const pages = Math.max(1, Math.ceil(total / state.pageSize));
      if (state.page > pages) state.page = pages;

      const start = (state.page - 1) * state.pageSize;
      const pageItems = items.slice(start, start + state.pageSize);

      $("catalogList").innerHTML = pageItems.map(b => {
        const hasImg = b.img && b.img.trim();
        return `
          <div class="book">
            <div class="thumb">${hasImg ? `<img src="${esc(b.img)}" alt="Portada">` : ""}</div>
            <div>
              <b>${esc(b.title || "Sin t√≠tulo")}</b>
              <span>${esc(b.author || "Autor")}</span>
            </div>
          </div>
        `;
      }).join("") || `<div class="small">No hay resultados.</div>`;

      $("pageInfo").textContent = `P√°gina ${state.page} / ${pages}`;
      $("resultInfo").textContent = `Mostrando ${pageItems.length} de ${total} resultados`;
      $("catCount").textContent = `${state.catalog.length} libros`;

      $("prevPage").disabled = state.page <= 1;
      $("nextPage").disabled = state.page >= pages;
    }

    // ========= Import / Export =========
    function importCatalogFromText(text){
      // Formato: T√≠tulo | Autor | imagenURL(opcional)
      const lines = text.split(/\r?\n/).map(x => x.trim()).filter(Boolean);
      const out = [];
      for (const line of lines){
        const parts = line.split("|").map(p => p.trim());
        if (!parts[0]) continue;
        out.push({
          title: parts[0],
          author: parts[1] || "",
          img: parts[2] || ""
        });
      }
      return out;
    }

    function exportCatalogToText(){
      return state.catalog.map(b => `${b.title} | ${b.author || ""} | ${b.img || ""}`.trim()).join("\n");
    }

    function resetDemo(){
      state.catalog = [...DEMO_CATALOG];
      localStorage.removeItem(LS_KEY);
      saveCatalog();
      $("importStatus").textContent = "‚úÖ Cat√°logo demo restaurado.";
    }

    // ========= UI counts =========
    function updateCounts(){
      $("priceNow").textContent = money(OFFER.priceNow);
      $("priceOld").textContent = money(OFFER.priceOld);
      $("count").textContent = `+ 300 libros`;
    }

    // ========= Init =========
    function init(){
      $("year").textContent = new Date().getFullYear();
      setWhatsAppLinks();
      updateCounts();
      renderSlider();

      $("next").addEventListener("click", nextSlide);
      $("prev").addEventListener("click", prevSlide);

      $("openCatalog").addEventListener("click", openModal);
      $("closeCatalog").addEventListener("click", closeModal);
      $("modalBack").addEventListener("click", (e)=>{ if(e.target === $("modalBack")) closeModal(); });

      $("search").addEventListener("input", (e)=>{ state.search = e.target.value; renderCatalog(true); });
      $("pageSize").addEventListener("change", (e)=>{ state.pageSize = Number(e.target.value); renderCatalog(true); });

      $("prevPage").addEventListener("click", ()=>{ state.page = Math.max(1, state.page-1); renderCatalog(); });
      $("nextPage").addEventListener("click", ()=>{
        const pages = Math.max(1, Math.ceil(filtered().length / state.pageSize));
        state.page = Math.min(pages, state.page+1);
        renderCatalog();
      });

      $("importBtn").addEventListener("click", ()=>{
        const txt = $("importBox").value.trim();
        if (!txt){
          $("importStatus").textContent = "‚ö†Ô∏è Pega tu lista primero.";
          return;
        }
        const imported = importCatalogFromText(txt);
        if (!imported.length){
          $("importStatus").textContent = "‚ö†Ô∏è No se detectaron libros. Usa: T√≠tulo | Autor | imagenURL(opcional)";
          return;
        }
        state.catalog = imported;
        saveCatalog();
        $("importStatus").textContent = `‚úÖ Importados ${imported.length} libros.`;
      });

      $("exportBtn").addEventListener("click", async ()=>{
        const txt = exportCatalogToText();
        $("importBox").value = txt;
        $("importStatus").textContent = "üì§ Cat√°logo exportado en el cuadro (puedes copiarlo).";
        try{ await navigator.clipboard.writeText(txt); $("importStatus").textContent += " ‚úÖ Copiado al portapapeles."; }catch{}
      });

      $("resetBtn").addEventListener("click", ()=>{
        if (confirm("¬øRestaurar cat√°logo demo? Esto reemplaza tu lista actual.")) resetDemo();
      });
    }
    init();
  </script>
</body>
</html>